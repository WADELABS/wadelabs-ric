# Wadelabs Integrity Case File #03
**Title:** Cross-Tenant Data Exposure via Export Path
**Severity:** CRITICAL
**Check ID:** RIC-04 (Data Export Leak)

---

## üö® The Failure
The "Download Invoice" feature used sequential/predictable IDs without validating tenant ownership of the requested object ID.

**Impact:**
User A (Tenant 101) could download User B's (Tenant 102) invoice by simply incrementing the ID in the URL: `/export/invoice/5001` -> `/export/invoice/5002`. This is a massive data breach vector (IDOR).

## üì∏ Evidence Artifacts

### 1. IDOR Validation Trace
**File:** `trace_ric_04_idor.zip`
> **Context:** Logged in as User A (Tenant 101).
> **Target:** Invoice #5002 (Belongs to Tenant 102).
> **Action:** `GET /export/invoice/5002`
> **Result:** `200 OK` (Content-Length: 45kb). **FAIL.**

### 2. Redacted Artifact
**File:** `leaked_invoice_sample.pdf`
(Screenshot showing Invoice #5002 headers visible to unauthorized user).

---

## üõ†Ô∏è Remediation
**Status:** FIXED in v3.0.1

*   **Root Cause:** Controller was checking *authentication* (is user logged in?) but not *authorization* (does user own resource #5002?).
*   **Fix:** Scoped all ORM queries to `current_tenant.invoices.find(id)`.
*   **Verification:** Re-ran RIC-04. Result: `404 Not Found` for cross-tenant ID.

---

*Generated by Wadelabs Release Integrity Check (RIC)*
