# Wadelabs Integrity Case File #01
**Title:** Session Revocation Failure Under Release Drift
**Severity:** CRITICAL
**Check ID:** RIC-01 (Logout Reality)

---

## üö® The Failure
During the release of **v2.4.0 (Auth Refactor)**, the system failed to invalidate server-side session tokens upon logout.

**Impact:**
Any user could re-use a captured token/cookie to perform privileged actions (Change Password, Transfer Funds) *after* clicking logout. This violates **OWASP ASVS V3.4.1**.

## üì∏ Evidence Artifacts

### 1. Replay Trace
**File:** `trace_ric_01_logout_fail.zip` (Playwright)
> **Step 4:** User clicks Logout.
> **Step 5:** Script injects saved `Authorization: Bearer eyJhb...` header.
> **Step 6:** Request to `POST /api/v1/user/settings` returns `200 OK` (Expected `401 Unauthorized`).

### 2. Network Log (HAR)
`[POST] /api/v1/user/settings`
**Status:** 200 OK
**Response:** `{"success": true, "message": "Settings updated"}`
**Timestamp:** +45s post-logout

---

## üõ†Ô∏è Remediation
**Status:** FIXED in v2.4.1

*   **Root Cause:** Redis invalidation call was wrapped in a generic `try/catch` block that silently failed during the auth migration.
*   **Fix:** Enforced strict invalidation. Added explicit `token_blacklist` check middleware.
*   **Verification:** Re-ran RIC-01. Result: `401 Unauthorized` confirmed.

---

*Generated by Wadelabs Release Integrity Check (RIC)*
